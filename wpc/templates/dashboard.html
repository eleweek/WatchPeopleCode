{% extends "base.html" %}
{% import "macros.html" as macros with context %}

{% block title %} WatchPeopleCode: dashboard {% endblock %}

{% block content %}
  <div class="container">
    <h2> Welcome to your dashboard, {{current_user.reddit_username}}!</h2>
    {% if current_user.subscribers.count() %}
      <h3> You have {{current_user.subscribers.count()}} subscribers!</h3>
    {% endif %}
    <p>
      <button type="button" class="btn btn-default btn-primary show-private-info-button">Show private info</button>
      <button type="button" class="btn btn-default btn-primary hide-private-info-button" style="display:none;">Hide private info</button>
    </p>
    <div class="private-info" style="display:none;">
      <form>
        <div class="form-group">
          <label for="rtmp_url">WPC RTMP URL</label>
          <input type="text" class="form-control" id="rtmp_url" readonly value="rtmp://{{config['RTMP_SERVER']}}/live" onclick="this.select();">
        </div>
        <div class="form-group">
          <label for="rtmp_key">WPC RTMP KEY</label>
          <input type="text" class="form-control" id="rtmp_key" readonly value="{{current_user.streaming_key()}}" onclick="this.select();">
        </div>
      </form>
      <hr>
      {{wtf.quick_form(rtmp_redirect_form)}}
    </div>
  <div>
{% endblock %}

{% block scripts %}
  {{super()}}
  <script>
    (function($, window, undefined){
      $(".show-private-info-button").click(function() {
        $(".show-private-info-button").hide();
        $(".hide-private-info-button").show();
        $(".private-info").show();
      });
      $(".hide-private-info-button").click(function() {
        $(".show-private-info-button").show();
        $(".hide-private-info-button").hide();
        $(".private-info").hide();
      });
    }($, window));
  </script>
{% endblock %}

